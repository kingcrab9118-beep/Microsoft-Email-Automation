# Microsoft 365 Email Automation System Configuration
# Copy this file to .env and replace placeholder values with your actual configuration

# =============================================================================
# Microsoft Graph API Configuration
# =============================================================================

# TODO: Replace with your Microsoft Tenant ID (found in Azure AD)
MICROSOFT_TENANT_ID=your-tenant-id-here

# TODO: Replace with your Azure App Registration Client ID
MICROSOFT_CLIENT_ID=your-client-id-here

# TODO: Replace with your Azure App Registration Client Secret
MICROSOFT_CLIENT_SECRET=your-client-secret-here

# TODO: Replace with the email address that will send the emails
SENDER_EMAIL=sender@yourdomain.com

# Authentication method: 'client_credentials' (app-only) or 'delegated' (user context)
# For automated systems, use 'client_credentials'
AUTH_METHOD=client_credentials

# =============================================================================
# Database Configuration
# =============================================================================

# Database connection string
# For SQLite (default): sqlite:///email_automation.db
# For Azure SQL: mssql+pyodbc://username:password@server/database?driver=ODBC+Driver+17+for+SQL+Server
DATABASE_URL=sqlite:///email_automation.db

# =============================================================================
# Rate Limiting Configuration
# =============================================================================

# Maximum emails to send per minute (Microsoft 365 limits apply)
RATE_LIMIT_PER_MINUTE=30

# Maximum emails to send per day
RATE_LIMIT_PER_DAY=10000

# =============================================================================
# Email Sequence Configuration
# =============================================================================

# Days to wait before sending follow-up email #1
FOLLOW_UP_1_DELAY_DAYS=14

# Whether to enable follow-up email #2 (true/false)
FOLLOW_UP_2_ENABLED=true

# Days to wait before sending follow-up email #2 (after follow-up #1)
FOLLOW_UP_2_DELAY_DAYS=10

# =============================================================================
# Reply Detection Configuration
# =============================================================================

# How often to check for replies (in minutes)
REPLY_CHECK_INTERVAL_MINUTES=15

# =============================================================================
# Required Microsoft Graph API Permissions
# =============================================================================
# When setting up your Azure App Registration, ensure you grant these permissions:
#
# Application Permissions (for client_credentials auth):
# - Mail.Send (to send emails)
# - Mail.Read (to detect replies)
#
# Delegated Permissions (for delegated auth):
# - Mail.Send (to send emails on behalf of user)
# - Mail.Read (to read user's mailbox for replies)
# - User.Read (to read user profile information)
#
# Don't forget to grant admin consent for these permissions in Azure Portal!